<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Table Definition</title>
  <style>
    .active {
      font-weight: bold;
    }
    a {
      text-decoration: none;
      color: #333;
    }

    a._1 {
      margin-left: 0px;
    }

    a._2 {
      margin-left: 0px;
    }

    a._3 {
      margin-left: 0px;
    }

    a._4 {
      margin-left: 0px;
    }

    a._5 {
      margin-left: 20px;
    }

    a._6 {
      margin-left: 40px;
    }
  </style>
</head>

<body style="display:grid;">
    <ul style="grid-column: 1; list-style-type: none;">
    <li><a style="font-weight: bold" href="/"><---</a></li>
    
    
    <li><a class="_4" href="/xyz/docs/developer/0-introduction/">Developer</a></li>
    
    
    
    <li><a class="_4" href="/xyz/docs/developer/1-license/">License</a></li>
    
    
    
    <li><a class="_4" href="/xyz/docs/developer/access/">Access</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/access/0registration/">User Account Registration</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/access/acl/">Access Control List (ACL)</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/access/failed-login-attempts/">Failed Login attempts</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/access/password-reset/">Password Reset</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/environment_settings/3rd-party-api-keys/">3rd Party API Keys</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/environment_settings/access-control/">Access Control</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/environment_settings/environment-settings/">Environment Settings</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/environment_settings/hosting/">Hosting</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/environment_settings/workspace-connections/">Workspace Connections</a></li>
    
    
    
    
    
    <li><a class="_6" href="/xyz/docs/developer/infoj/charts/cakeChart/">Cake charts</a></li>
    
    
    
    <li><a class="_6" href="/xyz/docs/developer/infoj/charts/polarChart/">Polar charts</a></li>
    
    
    
    <li><a class="_6" href="/xyz/docs/developer/infoj/charts/radarChart/">Radar charts</a></li>
    
    
    
    <li><a class="_6" href="/xyz/docs/developer/infoj/charts/readme/">Introduction</a></li>
    
    
    
    <li><a class="_6" href="/xyz/docs/developer/infoj/charts/simpleChart/">Simple charts</a></li>
    
    
    
    <li><a class="_6" href="/xyz/docs/developer/infoj/charts/stackedChart/">Stacked charts</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/infoj/clusterArea/">Cluster Area</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/infoj/filter/">Filter</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/infoj/geometry/">Geometry</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/infoj/groups/">Groups</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/infoj/">InfoJ</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/infoj/isolines/">Isolines</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/infoj/locations/">Locations</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/infoj/lookups/">Lookups</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/infoj/orderedlist/">Ordered List</a></li>
    
    
    
    <li class="active" ><a class="_5" href="/xyz/docs/developer/infoj/tabledefinition/">Table Definition</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/infoj/withSelect/">With Select</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/layers/charts/">Charts</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/layers/cluster-layer/">Cluster Layer</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/layers/filter/">Filter</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/layers/geojson-layer/">GeoJson Layer</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/layers/grid-hex/">Grid (Hex) Layer</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/layers/">Layers</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/layers/postgis-layer/">PostGIS Data Layer</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/layers/tables/">Tables</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/layers/tile-layer/">Tile Layer</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/layers/vector-tile-mvt-layer/">MapBox Vector Tile (MVT) Layer</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/locales/gazetteer/">Gazetteer</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/locales/">Locales</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/workspaces/access-restrictions/">Access Restrictions & Filters</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/workspaces/editing/">Editing</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/workspaces/locate/">Locate</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/workspaces/title/">Title</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/workspaces/workspace-checks/">Workspace Checks</a></li>
    
    
    
    <li><a class="_5" href="/xyz/docs/developer/workspaces/">Workspaces</a></li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
  </ul>
  
  <div  style="grid-column: 2;">
    <p>Location may have its own table view presenting relevant data when selected. Location table visibility can be toggled on and off from selection:</p>
<p><img src="../../../assets/img/table_definition_1.png" alt=""></p>
<p>Data are calculated against additional geometries which are associated with the location. They can use values calculated within subqueries as well as fixed expressions not related spatially.</p>
<pre><code class="language-text">&quot;infoj&quot;: [
  {
    &quot;type&quot;: &quot;tableDefinition&quot;,     // defines table
    &quot;title&quot;: &quot;Age Profile&quot;,        // required and unique within infoj
    &quot;columns&quot;: [],
    &quot;rows&quot;: [],
    &quot;agg&quot;: []                      // optional
  }
]
</code></pre>
<p><code>&quot;title&quot;</code> is a required parameter and must be unique within <code>infoj</code> definition. The <code>tableDefinition</code> object has 3 children: <code>columns</code> and <code>rows</code>. <code>agg</code> is optional property and can store values which need to be calculated from query results.</p>
<p><code>&quot;columns&quot;</code> stores geometry objects which will be used to calculate spatial aggregate. Configuration below creates 3 geometry columns for 5, 10, 15 minute drive time.</p>
<pre><code class="language-text">&quot;columns&quot;: [
                {
                  &quot;type&quot;: &quot;integer&quot;,            // PostgreSQL data type to return, defaults to &quot;text&quot;
                  &quot;label&quot;: &quot;0-5 mins&quot;,          // Nice column header, optional
                  &quot;field&quot;: &quot;min5&quot;,              // unique column alias, required
                  &quot;lookup&quot;: {                   // see lookup section
                    &quot;table_a&quot;: &quot;sites&quot;,
                    &quot;table_b&quot;: &quot;gb_hx_1k&quot;,
                    &quot;geom_a&quot;: &quot;isoline_5min&quot;,
                    &quot;geom_b&quot;: &quot;geomcntr&quot;
                  }
                },
                {
                  &quot;type&quot;: &quot;integer&quot;,
                  &quot;label&quot;: &quot;0-10 mins&quot;,
                  &quot;field&quot;: &quot;min10&quot;,
                  &quot;lookup&quot;: {
                    &quot;table_a&quot;: &quot;sites&quot;,
                    &quot;table_b&quot;: &quot;gb_hx_1k&quot;,
                    &quot;geom_a&quot;: &quot;isoline_10min&quot;,
                    &quot;geom_b&quot;: &quot;geomcntr&quot;
                  }
                },
                {
                  &quot;type&quot;: &quot;integer&quot;,
                  &quot;label&quot;: &quot;0-15 mins&quot;,
                  &quot;field&quot;: &quot;min15&quot;,
                  &quot;lookup&quot;: {
                    &quot;table_a&quot;: &quot;sites&quot;,
                    &quot;table_b&quot;: &quot;gb_hx_1k&quot;,
                    &quot;geom_a&quot;: &quot;isoline_15min&quot;,
                    &quot;geom_b&quot;: &quot;geomcntr&quot;
                  }
                }
</code></pre>
<p>In order to include total aggregate value (like 'UK Total' column in the example) another column object must be added with the following setup:</p>
<pre><code class="language-text">&quot;columns&quot;: [
  {
    &quot;field&quot;: &quot;uk&quot;,  // PostgreSQL alias, required and unique column alias
    &quot;aspatial&quot;: &quot;age_under_18_uk, age_18to24_uk, age_25to29_uk, age_30to44_uk ,age_45to59_uk, age_60plus_uk, age_total_uk FROM public.report_summary&quot; 
  } 
]
</code></pre>
<p><code>&quot;aspatial&quot;</code> contains a query which returns fixed values in a subquery. These values are stored in a separated table they can be queried from to avoid unnecessary calculation on the fly.</p>
<p><code>&quot;rows&quot;</code> stores fields or expressions for each row of the table.</p>
<pre><code class="language-text">&quot;rows&quot;: [
                {
                  &quot;field&quot;: &quot;age_under_18&quot;, // PostgreSQL alias, required and unique column alias
                  &quot;label&quot;: &quot;&lt; 18&quot;,         // nice label to display, optional
                  &quot;fieldfx&quot;: &quot;SUM(pop__11 - age_18to19__11 - age_20to24__11 - age_25to29__11 - age_30to44__11 - age_45to59__11 - age60plus)&quot;
                },
                {
                  &quot;field&quot;: &quot;age_18to24&quot;,
                  &quot;fieldfx&quot;: &quot;SUM(age_18to19__11 + age_20to24__11)&quot;,
                  &quot;label&quot;: &quot;18 to 24&quot;
                },
                {
                  &quot;field&quot;: &quot;age_25to29&quot;,
                  &quot;fieldfx&quot;: &quot;SUM(age_25to29__11)&quot;, // SQL statement aliased with field property
                  &quot;label&quot;: &quot;25 to 29&quot;
                },
                {
                  &quot;field&quot;: &quot;age_30to44&quot;,
                  &quot;fieldfx&quot;: &quot;SUM(age_30to44__11)&quot;,
                  &quot;label&quot;: &quot;30 to 44&quot;
                },
                {
                  &quot;field&quot;: &quot;age_45to59&quot;,
                  &quot;fieldfx&quot;: &quot;SUM(age_45to59__11)&quot;,
                  &quot;label&quot;: &quot;45 to 59&quot;
                },
                {
                  &quot;field&quot;: &quot;age_60plus&quot;,
                  &quot;fieldfx&quot;: &quot;SUM(age60plus)&quot;,
                  &quot;label&quot;: &quot;60+&quot;
                },
                {
                  &quot;field&quot;: &quot;age_profile_total&quot;,
                  &quot;fieldfx&quot;: &quot;SUM(pop__11)&quot;,
                  &quot;label&quot;: &quot;Total&quot;
                }
              ]
</code></pre>
<p>&quot;agg&quot; is an optional parameter and it stores columns calculated from query results (i. e. &quot;rows&quot;). In the table above there are 3 columns based on either calculation from results or aspatial column: % with 15 min and Age Profile Index both based on 15 minute catchment results and UK Total which is an aspatial (fixed) value for each row.</p>
<p>For those 3 sets of values the configuration below was used:</p>
<pre><code class="language-text">&quot;agg&quot;: {
          &quot;share15&quot;: { // key is unique column alias
              &quot;label&quot;: &quot;% with 15 min&quot;,
              &quot;type&quot;: &quot;integer&quot;,
              &quot;rows&quot;: [
                &quot;100*min15.age_under_18/min15.age_profile_total&quot;, // expression for each row
                &quot;100*min15.age_18to24/min15.age_profile_total&quot;,
                &quot;100*min15.age_25to29/min15.age_profile_total&quot;,
                &quot;100*min15.age_30to44/min15.age_profile_total&quot;,
                &quot;100*min15.age_45to59/min15.age_profile_total&quot;,
                &quot;100*min15.age_60plus/min15.age_profile_total&quot;,
                &quot;100*min15.age_profile_total/min15.age_profile_total&quot;
              ]
          },
          &quot;age_uk_total&quot;: {
              &quot;label&quot;: &quot;UK Total&quot;,
              &quot;type&quot;: &quot;integer&quot;,
              &quot;rows&quot;: [
                &quot;uk.age_under_18_uk&quot;,
                &quot;uk.age_18to24_uk&quot;,
                &quot;uk.age_25to29_uk&quot;,
                &quot;uk.age_30to44_uk&quot;,
                &quot;uk.age_45to59_uk&quot;, 
                &quot;uk.age_60plus_uk&quot;, 
                &quot;uk.age_total_uk&quot;
              ]
          },
          &quot;age_index&quot;: {
              &quot;label&quot;: &quot;Age Profile Index&quot;,
               &quot;type&quot;: &quot;numeric(1000, 2)&quot;,
               &quot;rows&quot;: [
                  &quot;uk.age_total_uk*(100*min15.age_under_18/min15.age_profile_total)/uk.age_under_18_uk&quot;,
                  &quot;uk.age_total_uk*(100*min15.age_18to24/min15.age_profile_total)/uk.age_18to24_uk&quot;,
                  &quot;uk.age_total_uk*(100*min15.age_25to29/min15.age_profile_total)/uk.age_25to29_uk&quot;,
                  &quot;uk.age_total_uk*(100*min15.age_30to44/min15.age_profile_total)/uk.age_30to44_uk&quot;,
                  &quot;uk.age_total_uk*(100*min15.age_45to59/min15.age_profile_total)/uk.age_45to59_uk&quot;,
                  &quot;uk.age_total_uk*(100*min15.age_60plus/min15.age_profile_total)/uk.age_60plus_uk&quot;,
                  &quot;uk.age_total_uk*(100*min15.age_profile_total/min15.age_profile_total)/uk.age_total_uk&quot;
                ]
              }
            }
</code></pre>
<h2>Sorting</h2>
<p>Table sort requests will now be sent to the backend.
If you show 99 out of n records then the 99 records will be retrieved after sorting.</p>
<h2>Viewport Flag</h2>
<p>Layer table now has a viewport flag, which is set to false by default. This can be toggled with a button in the tableview control itself.</p>
<p><img src="../../../assets/img/table_definition_2.png" alt=""></p>
<p>When the viewport is off, the layer table will not update with viewport changes since all data is down.</p>
<p>This will work together with sorting the layer table.</p>
<p><img src="../../../assets/img/table_definition_3.png" alt=""></p>
<h2>Selecting Location</h2>
<p>You can select a row in the table view that will point to said location on the map.</p>
<p><img src="../../../assets/img/table_definition_4.png" alt=""></p>

  </div>
</body>

</html>